<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Finding the Root of a Function – Computational Physics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06-extrema.html" rel="next">
<link href="./04-interpolation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-0dd2bd5de344125cf763a379ddc3eb04.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-roots.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Finding the Root of a Function</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Computational Physics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-interpolation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Interpolation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-roots.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Finding the Root of a Function</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-extrema.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Minimization and Maximization of Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-integration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Numerical Integration</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-odes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Numerical Integration of Ordinary Differential Equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The Modeling of Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-bisection" id="toc-sec-bisection" class="nav-link active" data-scroll-target="#sec-bisection"><span class="header-section-number">2.1</span> The Method of Bracketing and Bisection</a>
  <ul class="collapse">
  <li><a href="#plotting-functions-in-gnuplot" id="toc-plotting-functions-in-gnuplot" class="nav-link" data-scroll-target="#plotting-functions-in-gnuplot">Plotting Functions in <code>gnuplot</code></a></li>
  </ul></li>
  <li><a href="#the-newton-raphson-method" id="toc-the-newton-raphson-method" class="nav-link" data-scroll-target="#the-newton-raphson-method"><span class="header-section-number">2.2</span> The Newton-Raphson Method</a></li>
  <li><a href="#root-finding-in-python" id="toc-root-finding-in-python" class="nav-link" data-scroll-target="#root-finding-in-python"><span class="header-section-number">2.3</span> Root Finding in Python</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-roots" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Finding the Root of a Function</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The need to determine the roots of a function – i.e.&nbsp;where that function crosses the x-axis – is a recurring problem in practical and computational physics. For example, the density of matter in the interior of a star may be approximately represented by a type of function called a polytropic function. The edge or surface of the star occurs where the appropriate polytropic function goes to zero. There are many other examples. All of you know how to find analytically the roots of a parabola. For more complex functions, it may not be possible or easy to find the roots analytically, and so it is necessary to use numerical methods. The numerical method that is used depends upon whether or not it is possible to determine the derivative of the function. The function, for instance, may be given to us as a “black box” – it may be in tabular form, or given to us as a “C” function, or it may be known only through a recursion equation. In such a case, the appropriate method would be to more and more closely bracket the root until we know it to the precision that we desire. Alternately, we may be able to differentiate the function. In that case, we can use the Newton-Raphson method (or similar methods) to zero in on the root.</p>
<section id="sec-bisection" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="sec-bisection"><span class="header-section-number">2.1</span> The Method of Bracketing and Bisection</h2>
<p>The first thing that we need to know in root-finding is an approximate location of the root we are interested in. How can we determine this? The easiest way is to use a plotting program, such as <code>gnuplot</code>, <code>EXCEL</code>, etc., to plot the function. Another way is to calculate the function at a number of points. Then, unless the function is pathological in some way, we can say that a root exists in the interval <span class="math inline">\((a, b)\)</span> if <span class="math inline">\(f(a)\)</span> and <span class="math inline">\(f(b)\)</span> have opposite signs. An exception to this is a function with a singularity in this interval. Suppose <span class="math inline">\(c\)</span> is in the interval <span class="math inline">\((a, b)\)</span>, and the function is given by <span class="math display">\[
f(x) = \frac{1}{x - c}
\]</span> Then, <span class="math inline">\(f(x)\)</span> has a singularity at <span class="math inline">\(c\)</span> and not a root. There are other pathological functions such as <span class="math inline">\(\sin(1/x)\)</span>, which has infinitely many roots in the vicinity of <span class="math inline">\(x = 0\)</span>. So, the user must be aware of such problems, as such pathologies will give problems to even the most clever programs.</p>
<p>Let us assume that our function is fairly free of pathologies and that we know that there is a root in the interval <span class="math inline">\((a, b)\)</span> and that we want to find it more exactly.</p>
<p>The simplest way to proceed is using the method of <em>bisection</em>. This method is straightforward. If we know that a root is in <span class="math inline">\((a, b)\)</span> because <span class="math inline">\(f(a)\)</span> has a different sign from <span class="math inline">\(f(b)\)</span>, then evaluate the function <span class="math inline">\(f\)</span> at the midpoint of the interval, <span class="math inline">\((a + b)/2\)</span>, and examine its sign. Replace whichever limit (e.g. <span class="math inline">\(a\)</span> or <span class="math inline">\(b\)</span>) that has the same sign. Repeat the process until the interval is so small that we know the location of the root to the desired accuracy.</p>
<p>The “desired” accuracy must be within limits. As we have discussed before in class and lab, since computers use a fixed number of binary digits to represent floating-point numbers, there is a limit to the accuracy with which computers can represent numbers. To be precise, the smallest floating-point number which, when added to the floating-point number <span class="math inline">\(1.0\)</span>, produces a floating-point number different from <span class="math inline">\(1.0\)</span>, is termed the <em>machine accuracy</em>, <span class="math inline">\(\epsilon_m\)</span>. Using single precision, most machines have <span class="math inline">\(\epsilon_m \approx 1 \times 10^{-8}\)</span>. Using double precision, <span class="math inline">\(\epsilon_m \approx 1 \times 10^{-16}\)</span>. It is always a good idea to back off from these numbers, and thus setting <span class="math inline">\(\epsilon_m\)</span> to <span class="math inline">\(10^{-6}\)</span> and <span class="math inline">\(10^{-14}\)</span> respectively are practical limits. Sometimes even those limits are too optimistic. Let us suppose that our <span class="math inline">\((n - 1)^{\text{th}}\)</span> and <span class="math inline">\(n^{\text{th}}\)</span> evaluations of the midpoint are <span class="math inline">\(x_{n-1}\)</span> and <span class="math inline">\(x_n\)</span>, and that the root was initially in the interval <span class="math inline">\((a, b)\)</span>. We would then be justified in stopping our search if <span class="math inline">\(|x_n - x_{n-1}| &lt; \epsilon_m |b - a|\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Exercise 5.1">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Exercise 5.1
</div>
</div>
<div class="callout-body-container callout-body">
<p>The polynomial <span class="math inline">\(f(x) = 5x^2 + 9x - 80\)</span> has a root in the interval <span class="math inline">\((3, 4)\)</span>. Find the root to a precision of <span class="math inline">\(10^{-6}\)</span> using the <em>bisection</em> method. Verify your root analytically.</p>
</div>
</div>
<section id="plotting-functions-in-gnuplot" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="plotting-functions-in-gnuplot">Plotting Functions in <code>gnuplot</code></h3>
<p>When finding roots, it is a good idea to plot the function to get an idea of the position of the roots. This can be done in <code>gnuplot</code>. To plot the function of Exercise 5.1, enter the following commands:</p>
<pre class="text"><code>gnuplot&gt; f(x) = 5*x**2 + 9*x - 80
gnuplot&gt; plot f(x)
gnuplot&gt; g(x) = 0
gnuplot&gt; replot g(x)</code></pre>
<p>Note that exponentiation in <code>gnuplot</code> is accomplished with “<code>**</code>”. Notice in the plot that <span class="math inline">\(f(x)\)</span> has a root at about -5 and another between 3 and 4.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Exercise 5.2">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Exercise 5.2
</div>
</div>
<div class="callout-body-container callout-body">
<p>Bessel functions <span class="math inline">\(J_0(x)\)</span>, <span class="math inline">\(J_1(x)\)</span>, etc. often turn up in mathematical physics, especially in the context of optics and diffraction. The file <code>comphys.c</code> has a canned version of the Bessel function <span class="math inline">\(J_0(x)\)</span>. The function declaration (contained in the file <code>comphys.h</code>) for this function is</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dt">float</span> bessj0<span class="op">(</span><span class="dt">float</span> x<span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Modify your program from Exercise 5.1 to find the first two positive roots of <span class="math inline">\(J_0(x)\)</span>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Exercise 5.3">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Exercise 5.3
</div>
</div>
<div class="callout-body-container callout-body">
<p>The viscosity of air (in micropascal seconds) is given to good accuracy by the following polynomial (valid between <span class="math inline">\(T = 100\,\text{K}\)</span> and <span class="math inline">\(600\,\text{K}\)</span>):</p>
<p><span class="math display">\[
\eta = 3.61111 \times 10^{-8} T^3 - 6.95238 \times 10^{-5} T^2 + 0.0805437\,T - 0.3
\]</span></p>
<p>Use this polynomial to find the temperature <span class="math inline">\(T\)</span> at which <span class="math inline">\(\eta = 20.1\,\mu\text{Pa}\cdot\text{s}\)</span>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Exercise 5.4">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Exercise 5.4
</div>
</div>
<div class="callout-body-container callout-body">
<p>An atomic state decays with two time constants <span class="math inline">\(\tau_1\)</span> and <span class="math inline">\(\tau_2\)</span> and can be described by the equation:</p>
<p><span class="math display">\[
N = \frac{N_0}{2} \left( e^{-t/\tau_1} + e^{-t/\tau_2} \right)
\]</span></p>
<p>Find, by the method of bisection, the time at which <span class="math inline">\(N = N_0 / 2\)</span>, i.e., the half-life of the state. Let <span class="math inline">\(\tau_1 = 5.697\)</span> and <span class="math inline">\(\tau_2 = 9.446\)</span>. The program should first display (with <code>gnuplot</code>) the function (use <span class="math inline">\(N_0 = 100.0\)</span>) and then prompt the user for an initial bracket. Hints: <code>gnuplot</code> does not recognize the variable <code>t</code>, so use <code>x</code> instead. You may wish to add the command <code>set xrange [0:15]</code> just before the <code>plot f(x)</code> command to give the plot a nice scaling. Use <code>exp(x)</code> for <span class="math inline">\(e^x\)</span> in <code>gnuplot</code>.</p>
</div>
</div>
</section>
</section>
<section id="the-newton-raphson-method" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="the-newton-raphson-method"><span class="header-section-number">2.2</span> The Newton-Raphson Method</h2>
<p>If we can calculate the first derivative of our function, then we can use a speedier (although somewhat more dangerous) method called the Newton-Raphson method.</p>
<p>Let us suppose that we have a function as illustrated below, which has a root at <span class="math inline">\(x = x_r\)</span>, and that we have a rough estimate for that root of <span class="math inline">\(x = x_0\)</span>. Let us evaluate the derivative of this function at <span class="math inline">\(x_0\)</span>, <span class="math inline">\(f'(x_0)\)</span>. This derivative will be the slope of the tangent line to the function at the point <span class="math inline">\((x_0, f(x_0))\)</span>, and you can see that where it crosses the <span class="math inline">\(x\)</span>-axis, <span class="math inline">\(x_1\)</span>, is a much better estimate to the root of the function than <span class="math inline">\(x_0\)</span>.</p>
<p>The process can be repeated to give an even better estimate, and so on. The equation of the first tangent line is (the student should verify):</p>
<p><span class="math display">\[
y = f'(x_0)(x - x_0) + f(x_0)
\]</span></p>
<p>If we set <span class="math inline">\(y = 0\)</span> to find the root of this line, we get</p>
<p><span class="math display">\[
x_1 = x_0 - \frac{f(x_0)}{f'(x_0)}
\]</span></p>
<p>From this, we can derive the Newton–Raphson formula for the <span class="math inline">\(n^{\text{th}}\)</span> estimate of the root: <span class="math display">\[
x_n = x_{n-1} - \frac{f(x_{n-1})}{f'(x_{n-1})}
\]</span></p>
<div id="c497ded8" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05-roots_files/figure-html/cell-2-output-1.png" width="405" height="476" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Exercise 5.5">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Exercise 5.5
</div>
</div>
<div class="callout-body-container callout-body">
<p>Write a program to find the root for the polynomial of Exercise 5.1 using the Newton–Raphson method. Begin with an estimate <span class="math inline">\(x_0 = 4\)</span>. See what happens if you use a different starting point. Explore both positive and negative values for the starting point.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Exercise 5.6">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Exercise 5.6
</div>
</div>
<div class="callout-body-container callout-body">
<p>Write a program to solve the problem of Exercise 5.3 using the Newton–Raphson method. Begin with an estimate of <span class="math inline">\(200\,\text{K}\)</span>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Exercise 5.7">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Exercise 5.7
</div>
</div>
<div class="callout-body-container callout-body">
<p>Write a program to solve the problem of Exercise 5.4 using the Newton–Raphson method.</p>
</div>
</div>
<p>An obvious danger to the Newton-Raphson method is that if there is a minimum or a maximum between the root and your starting point, the method will either not converge to the desired root at all, but to another one, or wander out to ±∞ at an ever accelerating pace. In addition, if you happen by bad luck to choose your beginning point at a maximum or minimum point, your program will never converge, but will blow up! Hence, as always, you should have a pretty good idea of the nature of your function before you attempt to find and “polish” roots.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Exercise 5.8">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Exercise 5.8
</div>
</div>
<div class="callout-body-container callout-body">
<p>Use the fact that</p>
<p><span class="math display">\[
\frac{dJ_0(x)}{dx} = -J_1(x)
\]</span></p>
<p>to calculate the first two roots of <span class="math inline">\(J_0(x)\)</span>.</p>
<p>The code for <span class="math inline">\(J_1(x)\)</span> is in the file <code>comphys.c</code>, and the function definition is</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dt">float</span> bessj1<span class="op">(</span><span class="dt">float</span> x<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>which is contained in <code>comphys.h</code>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Exercise 5.9 An Iterative Problem">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Exercise 5.9 An Iterative Problem
</div>
</div>
<div class="callout-body-container callout-body">
<p>In ballistics, it is common to solve the equations of motion of a particle shot at an angle, <span class="math inline">\(\theta\)</span>, above a horizontal surface with an initial velocity <span class="math inline">\(v_0\)</span>. The effects of air resistance play an important role that is often neglected in introductory or intermediate coursework. If the force of air resistance can be modeled as:</p>
<p><span class="math display">\[
F_x = -k m \dot{x} \tag{1}
\]</span></p>
<p><span class="math display">\[
F_y = -k m \dot{y} \tag{2}
\]</span></p>
<p>then the <span class="math inline">\(x(t)\)</span> and <span class="math inline">\(y(t)\)</span> solutions are:</p>
<p><span class="math display">\[
x(t) = \frac{v_0 \cos \theta}{k} \left( 1 - e^{-k t} \right) \tag{3}
\]</span></p>
<p><span class="math display">\[
y(t) = - \frac{gt}{k} + \frac{k v_0 \sin \theta + g}{k^2} \left( 1 - e^{-k t} \right)  \tag{4}
\]</span></p>
<p>The time of flight of the projectile (the time elapsed before the projectile lands) is given as:</p>
<p><span class="math display">\[
T = \frac{v_0 \sin \theta + g}{gk} \left( 1 - e^{-k T} \right) \tag{5}
\]</span></p>
<p>Notice that <span class="math inline">\(T\)</span> appears on both sides of equation (5). This is known as a “transcendental equation” which can be solved numerically using iteration. Note that this equation collapses to the simple expression for <span class="math inline">\(T\)</span> when resistance is neglected (<span class="math inline">\(k = 0\)</span>):</p>
<p><span class="math display">\[
T(k=0) = \frac{2 v_0 \sin \theta}{g} \tag{6}
\]</span></p>
<p>The range of motion (the distance traveled by the projectile before landing) is:</p>
<p><span class="math display">\[
R = x(t = T) \tag{7}
\]</span></p>
<p>In the exercises below, use <span class="math inline">\(\theta = 60^\circ\)</span>, <span class="math inline">\(v_0 = 600 \, \text{m/s}\)</span>, and <span class="math inline">\(|g| = 9.8 \, \text{m/s}^2\)</span>.</p>
<ol type="a">
<li><p>Solve for <span class="math inline">\(T\)</span> (equation 5) numerically using iteration. In the first iteration, use the non-resistive expression for <span class="math inline">\(T\)</span> (equation 6). Iterate until the solution converges to within a user-defined tolerance (error) – e.g., <span class="math inline">\(\Delta T\)</span> over successive iterations is less than the tolerance. Use a value of <span class="math inline">\(k = 0.005\)</span> for this part only.</p></li>
<li><p>Find the value of <span class="math inline">\(k\)</span> that allows the projectile to travel 1500 meters (<span class="math inline">\(R = 1500\,\text{m}\)</span>).</p></li>
<li><p>[<strong>GRAD STUDENTS ONLY</strong>] Plot <span class="math inline">\(y\)</span> vs.&nbsp;<span class="math inline">\(x\)</span> using gnuplot for <span class="math inline">\(k\)</span> values of 0.0, 0.005, 0.01, 0.02, 0.04, and 0.08. Also, show analytically how to get equation (6) from equation (5) (<em>Hint: Use perturbation methods – i.e., expand <span class="math inline">\(1 - e^{-kT}\)</span> in a power series expansion, and keep only the first few terms</em>).</p></li>
</ol>
</div>
</div>
</section>
<section id="root-finding-in-python" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="root-finding-in-python"><span class="header-section-number">2.3</span> Root Finding in Python</h2>
<p>In SciPy all of the root finding methods are in the <a href="https://docs.scipy.org/doc/scipy/reference/optimize.html" target="_blank"><code>optimize</code></a> subpackage.</p>
<p>To show off how it is done consider this suspiciously familiar function</p>
<div id="5c02a00d" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.special <span class="im">import</span> j0</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">'figure.figsize'</span>: (<span class="dv">7</span>, <span class="dv">2</span>),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">'axes.spines.top'</span>: <span class="va">False</span>, </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">'axes.spines.right'</span>: <span class="va">False</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">16</span>, <span class="dv">400</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>ax.plot(x, j0(x))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05-roots_files/figure-html/cell-3-output-1.png" width="571" height="189" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>All of the root finding algorithems for scalar functions can be accessed via a single method <code>root_scalar</code>.</p>
<p>Let’s use a different method for each root! We need to supply a bracket for where to limit our search and a method name.</p>
<div id="28e7f09f" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> root_scalar</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>method <span class="op">=</span> [<span class="st">'bisect'</span> ,<span class="st">'brentq'</span> ,<span class="st">'brenth'</span> ,<span class="st">'ridder'</span> ,<span class="st">'toms748'</span>]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>bracket <span class="op">=</span> [[<span class="dv">2</span>,<span class="dv">4</span>], [<span class="dv">5</span>,<span class="dv">7</span>], [<span class="dv">8</span>, <span class="dv">10</span>], [<span class="dv">11</span>,<span class="dv">13</span>], [<span class="dv">14</span>, <span class="dv">16</span>]]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> m, b <span class="kw">in</span> <span class="bu">zip</span>(method, bracket):</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    results.append(root_scalar(j0, bracket<span class="op">=</span>b, method<span class="op">=</span>m))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>ax.plot(x, j0(x))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> result <span class="kw">in</span> results:</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    ax.plot(result.root, <span class="dv">0</span>, <span class="st">'o'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="05-roots_files/figure-html/cell-4-output-1.png" width="571" height="189" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A call to <code>root_scaler</code> retuns a <code>RootResults</code> object which contains more information than only the root value.</p>
<div id="f810adf2" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">0</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>      converged: True
           flag: converged
 function_calls: 42
     iterations: 40
           root: 2.404825557694494
         method: bisect</code></pre>
</div>
</div>
<p>For a full overview of the supported methods see the <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root_scalar.html#scipy.optimize.root_scalar" target="_blank"><code>root_scalar</code></a> documentation.</p>
<p>Optimization is a vast subject of which we will cover more in the next chapter.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./04-interpolation.html" class="pagination-link" aria-label="Interpolation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Interpolation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06-extrema.html" class="pagination-link" aria-label="Minimization and Maximization of Functions">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Minimization and Maximization of Functions</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>